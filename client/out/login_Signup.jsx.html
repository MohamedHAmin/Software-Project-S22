<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: login/Signup.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: login/Signup.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React from "react";
import { useState } from "react";
import { useNavigate } from "react-router-dom";
import { Formik, Form, Field, ErrorMessage } from "formik";
import * as Yup from "yup";
import axios from "axios";
import classes from "./Styles/Signup.module.css";
import Navbar from "./navbar";
import { Avatar } from "@material-ui/core";
import Addpic from "./Addpic";

/**
 *
 *
 * @returns Returns 2 signup forms , First One with necessary data [screenName , Tag , Email and Password] and the Second One contains [Birthdate, Phone Number and Biography]
 */
const Signup = () => {
  const [error2, setError2] = useState(false);
  const [error1, setError1] = useState(false);
  const [next, setNext] = useState(false);
  const [userData, setUserData] = useState();
  const formdata = new FormData();
  const avaterformdata = new FormData();

  const [banner, setbanner] = useState();
  console.log("ðŸš€ ~ file: Signup.jsx ~ line 25 ~ Signup ~ banner", banner);
  const [avatar, setavatar] = useState();
  console.log("ðŸš€ ~ file: Signup.jsx ~ line 29 ~ Signup ~ avatar", avatar)
  const addAavater = (avater) => {
    setavatar(avater);
  };

  const addBanner = (baner) => {
    setbanner(baner);
  };

  const initialValues1 = {
    screenName: "",
    tag: "",
    email: "",
    password: "",
  };

  const initialValues2 = {
    phoneNumber: "",
    birth: { date: "" },
    Biography: "",
    location: { place: "" },
    website: "",
  };

  const Navigate = useNavigate();

  const validationSchema1 = Yup.object().shape({
    password: Yup.string()
      .matches(/^(\S+$)/, "You entered a space ,please remove it")
      .min(6)
      .max(16)
      .required("Enter Your Password"),
    email: Yup.string()
      .email("Must be a valid email")
      .max(255)
      .required("Email is required"),
    screenName: Yup.string().min(3).required("Enter Your screenName"),
    tag: Yup.string()
      .matches(/^(\S+$)/, "You entered a space ,please remove it")
      .required("Tag is required"),
  });

  const validationSchema2 = Yup.object().shape({
    // phoneNumber: Yup.string().matches(
    //   /^((\\+[1-9]{1,4}[ \\-])|(\\([0-9]{2,3}\\)[ \\-])|([0-9]{2,4})[ \\-])?[0-9]{3,4}?[ \\-]*[0-9]{3,4}?$/,
    //   "Phone number is not valid"
    // ),
    Biography: Yup.string(),
    // birth: { date: Yup.string().matches(/^(\S+$)/, 'you entered a space ,please remove it') }
  });
  const onSubmit1 = (data) => {
    setUserData(data);
    setNext(true);
  };

  const onSubmit2 = async(data) => {
    try {
        
        console.log(document.querySelector("#BD").value);

    data.screenName = userData.screenName;
    data.email = userData.email;
    data.password = userData.password;
    data.tag = userData.tag;

    data.birth.date = document.querySelector("#BD").value;
    console.log("ðŸš€ ~ file: Signup.jsx ~ line 81 ~ onSubmit2 ~ data", data);

    data.location.place = document.getElementById("Loc").value;

    console.log(data);

    const signupRes=await axios
      .post("http://larry-env.eba-u6mbx2gb.us-east-1.elasticbeanstalk.com/api/user/signup", data)
    console.log("ðŸš€ ~ file: Signup.jsx ~ line 100 ~ onSubmit2 ~ signupRes", signupRes)

      const userID = signupRes.data._id.toString();
      console.log("ðŸš€ ~ file: Signup.jsx ~ line 96 ~ .then ~ userID", userID);
      
      if(banner){
          
        formdata.append("image", banner);
        const bannerRes =await axios
        .put(`http://larry-env.eba-u6mbx2gb.us-east-1.elasticbeanstalk.com/api/profile/${userID}/banner`, formdata)
        console.log("ðŸš€ ~ file: Signup.jsx ~ line 109 ~ onSubmit2 ~ bannerRes", bannerRes)
      }
      if(avatar){
          
        avaterformdata.append("image", avatar);
        const avatarRes =await axios
        .put(`http://larry-env.eba-u6mbx2gb.us-east-1.elasticbeanstalk.com/api/profile/${userID}/avater`, avaterformdata)
        console.log("ðŸš€ ~ file: Signup.jsx ~ line 115 ~ onSubmit2 ~ avatarRes", avatarRes)

      }

      alert("Please check your email");

      Navigate("/");
    } catch (err) {
        console.log("ðŸš€ ~ file: Signup.jsx ~ line 127 ~ onSubmit2 ~ err", err)
        if (err.response.data.error.includes("tag")) {
            setError2("tag already used");
            setNext(false);
          } else {
            setError1("email already used");
            setNext(false);
          }
    }
    
      
 // navigate to login
   /*    })
      .catch((err) => {
        console.log(err.response.data.error);
        if (err.response.data.error.includes("tag")) {
          setError2("tag already used");
          setNext(false);
        } else {
          setError1("email already used");
          setNext(false);
        }
      }); */
  };

  const [openModal, setOpenModal] = useState(false);
  return (
    &lt;div>
      &lt;Navbar />
      &lt;div className={classes.container}>
        &lt;div className={classes.imageContainer}>
          &lt;img src="https://cdn.discordapp.com/attachments/949620839647698964/954738917968609290/d5acdefc-2d8c-41a4-b067-706cf76ee3aa.jpg">&lt;/img>
        &lt;/div>

        &lt;div className={classes.signupContainer}>
          &lt;div className={classes.title}>Signup Form &lt;/div>

          {!next &amp;&amp; (
            &lt;Formik
              initialValues={initialValues1}
              validationSchema={validationSchema1}
              onSubmit={onSubmit1}
            >
              &lt;Form>
                &lt;div className={classes.field}>
                  &lt;Field
                    name="screenName"
                    placeholder="screenName"
                    autoComplete="off"
                  />
                &lt;/div>
                &lt;ErrorMessage
                  name="screenName"
                  component="span"
                  className={classes.error}
                />

                &lt;div className={classes.field}>
                  &lt;Field name="tag" placeholder="Tag" autoComplete="off" />
                &lt;/div>
                &lt;ErrorMessage
                  name="tag"
                  component="span"
                  className={classes.error}
                />
                {error2 === false ? (
                  &lt;span>&lt;/span>
                ) : (
                  &lt;span className={classes.error}>{error2}&lt;/span>
                )}

                &lt;div className={classes.field}>
                  &lt;Field name="email" placeholder="Email" autoComplete="off" />
                &lt;/div>
                &lt;ErrorMessage
                  name="email"
                  component="span"
                  className={classes.error}
                />
                {error1 === false ? (
                  &lt;span>&lt;/span>
                ) : (
                  &lt;span className={classes.error}>{error1}&lt;/span>
                )}

                &lt;div className={classes.field}>
                  &lt;Field
                    type="password"
                    name="password"
                    placeholder="password"
                    autoComplete="off"
                  />
                &lt;/div>
                &lt;ErrorMessage
                  name="password"
                  component="span"
                  className={classes.error}
                />

                {/* &lt;Avatar src="/apple-touch-icon.png" sx={{ width: 200, height: 75, cursor: "pointer" }} /> */}

                &lt;div>
                  &lt;button className={classes.btnsup} type="submit">
                    Next{" "}
                  &lt;/button>
                &lt;/div>
              &lt;/Form>
            &lt;/Formik>
          )}
          {next &amp;&amp; (
            &lt;Formik
              initialValues={initialValues2}
              validationSchema={validationSchema2}
              onSubmit={onSubmit2}
            >
              &lt;Form>
                &lt;div className={classes.field}>
                  &lt;Field
                    id="BD"
                    type="date"
                    name="birthDate"
                    placeholder="dd/mm/yyyy"
                    autoComplete="off"
                  >&lt;/Field>
                &lt;/div>
                &lt;ErrorMessage
                  name="birthDate"
                  component="span"
                  className={classes.error}
                />

                &lt;div className={classes.field}>
                  &lt;Field
                    name="phoneNumber"
                    placeholder="Phone Number"
                    autoComplete="off"
                  >&lt;/Field>
                &lt;/div>
                &lt;ErrorMessage
                  name="phoneNumber"
                  component="span"
                  className={classes.error}
                />

                &lt;div className={classes.field}>
                  &lt;Field
                    id="bio"
                    name="Biography"
                    placeholder="Biography"
                    autoComplete="off"
                  >&lt;/Field>
                &lt;/div>
                &lt;ErrorMessage
                  name="Biography"
                  component="span"
                  className={classes.error}
                />

                &lt;div className={classes.field}>
                  &lt;Field
                    id="Loc"
                    name="dummylocation"
                    placeholder="Location"
                    autoComplete="off"
                  >&lt;/Field>
                &lt;/div>
                &lt;ErrorMessage
                  name="Location"
                  component="span"
                  className={classes.error}
                />

                &lt;div className={classes.field}>
                  &lt;Field
                    id="Link"
                    name="website"
                    placeholder="You can put any website link here"
                    autoComplete="off"
                  >&lt;/Field>
                &lt;/div>
                &lt;ErrorMessage
                  name="Link"
                  component="span"
                  className={classes.error}
                />

                &lt;div>
                  &lt;button
                    className={classes.btnsup1}
                    type="button"
                    onClick={() => {
                      setOpenModal(true);
                    }}
                  >
                    {" "}
                    Add photo
                  &lt;/button>
                  {openModal &amp;&amp; (
                    &lt;Addpic
                      closeModal={setOpenModal}
                      Abanner={addBanner}
                      Aavatar={addAavater}
                    />
                  )}
                &lt;/div>

                &lt;div>
                  &lt;button className={classes.btnsup1} type="submit">
                    Signup
                  &lt;/button>
                &lt;/div>
              &lt;/Form>
            &lt;/Formik>
          )}
        &lt;/div>
      &lt;/div>
    &lt;/div>
  );
};
export default Signup;

//npm install react-easy-crop --save
//npm i react-image-crop --save
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#AccInfoOptions">AccInfoOptions</a></li><li><a href="global.html#AccountInformationS">AccountInformationS</a></li><li><a href="global.html#AccountSettings">AccountSettings</a></li><li><a href="global.html#blue">blue</a></li><li><a href="global.html#ChangeNotificationsSettings">ChangeNotificationsSettings</a></li><li><a href="global.html#ChangePhoneNum">ChangePhoneNum</a></li><li><a href="global.html#ChangeUserTag">ChangeUserTag</a></li><li><a href="global.html#CommentDisplayBlock">CommentDisplayBlock</a></li><li><a href="global.html#contact">contact</a></li><li><a href="global.html#CreateCard">CreateCard</a></li><li><a href="global.html#CreateFollower">CreateFollower</a></li><li><a href="global.html#createImage">createImage</a></li><li><a href="global.html#EditProfile">EditProfile</a></li><li><a href="global.html#Explore">Explore</a></li><li><a href="global.html#FollowerCard">FollowerCard</a></li><li><a href="global.html#FollowersPage">FollowersPage</a></li><li><a href="global.html#FollowingCard">FollowingCard</a></li><li><a href="global.html#FollowingPage">FollowingPage</a></li><li><a href="global.html#Header">Header</a></li><li><a href="global.html#Homepage">Homepage</a></li><li><a href="global.html#ImageUploaderBanner">ImageUploaderBanner</a></li><li><a href="global.html#ImageUploaderProfile">ImageUploaderProfile</a></li><li><a href="global.html#Login">Login</a></li><li><a href="global.html#MakeBDvisible">MakeBDvisible</a></li><li><a href="global.html#MakeLocVisible">MakeLocVisible</a></li><li><a href="global.html#MyFollowers">MyFollowers</a></li><li><a href="global.html#MyFollowing">MyFollowing</a></li><li><a href="global.html#MyProfile">MyProfile</a></li><li><a href="global.html#MyProfileTabs">MyProfileTabs</a></li><li><a href="global.html#Navbar">Navbar</a></li><li><a href="global.html#NotificationSettings">NotificationSettings</a></li><li><a href="global.html#OthersProfile">OthersProfile</a></li><li><a href="global.html#Post">Post</a></li><li><a href="global.html#PostReplies">PostReplies</a></li><li><a href="global.html#PrivacySettings">PrivacySettings</a></li><li><a href="global.html#ProfileInfo">ProfileInfo</a></li><li><a href="global.html#ProfileName">ProfileName</a></li><li><a href="global.html#ProfilePage">ProfilePage</a></li><li><a href="global.html#Reacts">Reacts</a></li><li><a href="global.html#ReactsIcon">ReactsIcon</a></li><li><a href="global.html#Report">Report</a></li><li><a href="global.html#ReportAction">ReportAction</a></li><li><a href="global.html#ReportsPage">ReportsPage</a></li><li><a href="global.html#ReportsView">ReportsView</a></li><li><a href="global.html#RetweetDisplayBlock">RetweetDisplayBlock</a></li><li><a href="global.html#SettingsMenu">SettingsMenu</a></li><li><a href="global.html#SettingsMenuOptions">SettingsMenuOptions</a></li><li><a href="global.html#SettingsPage">SettingsPage</a></li><li><a href="global.html#SideBar">SideBar</a></li><li><a href="global.html#SideBarIcon">SideBarIcon</a></li><li><a href="global.html#Signup">Signup</a></li><li><a href="global.html#Tweet">Tweet</a></li><li><a href="global.html#TweetBar">TweetBar</a></li><li><a href="global.html#UpdatePassword">UpdatePassword</a></li><li><a href="global.html#UploaderBanner">UploaderBanner</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Tue May 17 2022 19:59:05 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
